<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PHUKET INTERNATIONAL HOSPITAL : โรงพยาบาลภูเก็ตอินเตอร์เนชั่นแนล</title>
    <link rel="stylesheet" href="./css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/covid19-2.css">
</head>

<body>

    <header>
            <!-- <nav class="navbar bg-white py-2">
                <div class="container-fluid">
                    <div class="d-flex">
                        <img class="my-auto me-2" src="/images/LOGO_v1.png" alt="" width="35px" height="35px">
                        <div class="nav-brand">
                            <p>PHUKET INTERNATIONAL HOSPITAL</p>
                            <p>โรงพยาบาลภูเก็ตอินเตอร์เนชั่นแนล</p>
                        </div>
                    </div>
                </div>
            </nav> -->
        <nav class="navbar bg-body-tertiary py-2">
            <div class="container-fluid">
                <div class="d-flex">
                    <img class="my-auto me-2" src="/images/LOGO_v1.png" alt="" width="35px" height="35px">
                    <div class="nav-brand">
                        <p>PHUKET INTERNATIONAL HOSPITAL</p>
                        <p>โรงพยาบาลภูเก็ตอินเตอร์เนชั่นแนล</p>
                    </div>
                </div>
              <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
              </button>
              <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasNavbar" aria-labelledby="offcanvasNavbarLabel">
                <div class="offcanvas-header">
                  <h5 class="offcanvas-title" id="offcanvasNavbarLabel">เมนู</h5>
                  <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
                </div>
                <div class="offcanvas-body">
                  <ul class="navbar-nav justify-content-end flex-grow-1 pe-3">
                    <li class="nav-item">
                      <a class="nav-link active" aria-current="page" href="#">หน้าแรก</a>
                    </li>
                    <li class="nav-item">
                      <a class="nav-link" href="./table_of_covid.html">ตารางแสดงสถานการณ์ COVID-19</a>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </nav>

    </header>
    <main>
        <section class="summary-section">
            <div class="container-fluid">
                <div class="row">
                    <!-- Summary card left side-->
                    <div class="offset-1 col-7">
                        <div class="row mb-3">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-body p-4">
                                        <div class="row custom-large-row">
                                            <div class="col-5">
                                                <p class="mb-2 fs-5 fw-semibold">ผู้ติดเชื้อสะสม</p>
                                                <div class="card bg-body-secondary border-0">
                                                    <div
                                                        class="card-body d-flex align-items-center justify-content-between">
                                                        <div>
                                                            <img class="me-2" src="/images/icon-up.png" alt=""
                                                                width="15px" height="18px">
                                                            <span class="fw-semibold">เพิ่มขึ้น</span>
                                                        </div>
                                                        <h3 id="new-case-api">3,001</h3>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-7 text-end my-auto font-card-1">
                                                <p id="total-case-api">4,463,557</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row custom-mini-row">
                            <div class="col-4">
                                <div class="card">
                                    <div class="card-body text-center">
                                        <p class="mb-2 fs-5 fw-semibold">กำลังรักษา</p>
                                        <h3 class="mb-1" id="recovered-api">34,056</h3>
                                        <div class="card bg-body-secondary border-0">
                                            <div
                                                class="card-body d-flex justify-content-between align-items-center p-2">
                                                <div class="fw-bold">
                                                    <img src="/images/icon-down.png" alt="" class="me-2" width="15px"
                                                        height="18px">
                                                    <span>ลดลง</span>
                                                </div>
                                                <h5 id="prev-api">842</h5>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>
                            <div class="col-4">
                                <div class="card">
                                    <div class="card-body text-center">
                                        <p class="mb-2 fs-5 fw-semibold">ผู้ป่วยหายแล้ว</p>
                                        <h3 class="mb-1" id="total-recovered-api">4,399,358</h3>
                                        <div class="card bg-body-secondary border-0">
                                            <div
                                                class="card-body d-flex justify-content-between align-items-center p-2">
                                                <div class="fw-bold">
                                                    <img src="/images/icon-up-green.png" alt="" class="me-1"
                                                        width="15px" height="18px">
                                                    <span>เพิ่มขึ้น</span>
                                                </div>
                                                <h5 id="diff-api">3,813</h5>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>
                            <div class="col-4">
                                <div class="card">
                                    <div class="card-body text-center">
                                        <p class="mb-2 fs-5 fw-semibold">เสียชีวิต</p>
                                        <h3 class="mb-1" id="new-death">30,143</h3>
                                        <div class="card bg-body-secondary border-0">
                                            <div
                                                class="card-body d-flex justify-content-between align-items-center p-2">
                                                <div class="fw-bold">
                                                    <img src="/images/icon-up.png" alt="" class="me-2" width="15px"
                                                        height="18px">
                                                    <span>เพิ่มขึ้น</span>
                                                </div>
                                                <h5 id="diff-death-c">30</h5>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Date status right side -->
                    <div class="col-4 d-flex justify-content-end align-items-start">
                        <div class="card rounded-pill custom-card-time fs-5 text-light text-center fw-semibold ms-auto">
                            <div class="card-body">
                                <span>สถานการณ์ Covid-19 ประจำวันที่</span>
                                <span id="update-api">20-03-2566</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section>
            <div class="graph-section py-5">
                <div class="container p-2">
                    <div class="row custom-graph-row">
                        <div class="col-4 d-flex justify-content-center align-items-center">
                            <img src="/images/bg-green-th.png" alt="" class="z-0 ms-3">
                            <div
                                class="text-graph-section text-center z-1 position-absolute fs-2 fw-semibold me-5 mt-3">
                                <p>สถานการณ์ผู้ติดเชื้อ</p>
                                <p class="fs-1 fw-bold">COVID-19</p>
                                <p>ทั้งหมดในประเทศไทย</p>
                            </div>

                        </div>
                        <div class="offset-1 col-7">
                            <canvas id="chart-api" class="custom-canvas"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>
    <footer>
        <div class="container-fluid">
            <div class="row p-3 custom-footer-row">
                <div class="col-10 d-flex justify-content-start align-items-center">
                    <img src="/images/LOGO_footer.png" alt="">
                    <div class="ms-2 text-light fw-medium">
                        <p>PHUKET INTERNATIONAL HOSPITAL</p>
                        <p>โรงพยาบาลภูเก็ตอินเตอร์เนชั่นแนล</p>
                    </div>
                </div>
                <div class="col-2 d-flex flex-column justify-content-start align-items-center">
                    <button class="btn border rounded-pill px-4 py-1 mb-2 text-light">ติดตามข่าวสารต่าง ๆ
                        ได้ที่</button>
                    <div class="icon-contact">
                        <a href=""><img src="/images/twiter.png" alt=""></a>
                        <a href=""><img src="/images/ig.png" alt=""></a>
                        <a href=""><img src="/images/yt.png" alt=""></a>
                        <a href=""><img src="/images/facebook.png" alt=""></a>
                        <a href=""><img src="/images/tictokpng.png" alt=""></a>
                    </div>
                </div>
            </div>
        </div>
    </footer>
</body>
</html>
<script src="js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/dayjs@1.11.7/dayjs.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.2.1/dist/chart.umd.min.js"></script>
<script>
    const new_c = document.getElementById("new-case-api"); //new_case
    const total_c = document.getElementById("total-case-api"); //total_case
    const update_c = document.getElementById("update-api");//update_date
    const chart_c = document.getElementById("chart-api");
    const recovered_c = document.getElementById("recovered-api");
    const prev_c = document.getElementById("prev-api");
    const total_recovered_c = document.getElementById("total-recovered-api")
    const diff_c = document.getElementById("diff-api");
    const new_death_c = document.getElementById("new-death");
    const diff_death_c = document.getElementById("diff-death-c");
    /*function draw_mockup_chart() {
        const chart_data = {
            labels: ['JAN', 'FEB', 'MAR', 'APR', 'MAY', 'JUN', 'JUL'], // axis x labels
            datasets: [
                {
                    label: 'New case',
                    data: [100, 10, 60, 40, 15, 32, 45],
                    fill: true,
                }, // first dataset
                {
                    label: 'New death',
                    data: [20, 15, 0, 23, 7, 2, 0],
                    fill: true,
                } // second dataset
            ]
        }
        const chart_config = {
            type: 'line',
            data: chart_data,
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: 'top',
                    },
                    title: {
                        display: true,
                        text: 'Covid-19 Line Chart'
                    }
                }
            },
        }
        const chartElem = new Chart(chart_c, chart_config)
    }*/
    function draw_covid_chart(covid_data) {
        let weeknum_arr = [];
        let new_case_arr = [];
        let new_death_arr = [];
        for(let i=1;i<covid_data.length;i++)
        {
            let last_weeknum_arr = covid_data[i]["weeknum"];
            let last_new_case_arr = covid_data[i]["new_recovered"];
            let last_new_death_arr = covid_data[i]["new_death"];
            weeknum_arr.push(last_weeknum_arr);
            new_case_arr.push(last_new_case_arr);
            new_death_arr.push(last_new_death_arr);
        }
        console.log(weeknum_arr);
        console.log(new_case_arr);
        console.log(new_death_arr);

        //[1, 2, 3, 4, 5]

        const chart_data = {
            labels: weeknum_arr, // axis x labels
            datasets: [
                {
                    label: 'ผู้ป่วยหายแล้ว',
                    data: new_case_arr,
                    fill: true,
                }, // first dataset
                {
                    label: 'ผู้ป่วยเสียชีวิต',
                    data: new_death_arr,
                    fill: true,
                } // second dataset
            ]
        }
        const chart_config = {
            type: 'line',
            data: chart_data,
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: 'right',
                        
                    },
                    title: {
                        display: true,
                        text: 'กราฟเปรียบเทียบสถานการณ์ COVID-19'
                    }
                }
            },
        }
        const chartElem = new Chart(chart_c, chart_config)
    }
    axios.get('https://covid19.ddc.moph.go.th/api/Cases/timeline-cases-all')
        .then((response) => {
            const last_data = response.data.slice(-1);
            const covert_date = dayjs(last_data[0]["update_date"]).format('DD-MM-YYYY');
            draw_covid_chart(response.data);
            //draw_mockup_chart();
            //convert date to dd-mm-yyyy
            //const date = last_data[0]["update_date"].slice(0,10); // 2023-04-07
            /*let dateSplit = date.split("-"); // ["2023", "04", "07"]
            dateSplit = dateSplit.reverse(); // ["07", "04", "2023"]
            const covert_date = dateSplit.join("-"); // '07/04/2023'*/
        
            //Post Data
            new_c.innerText = last_data[0]["new_case"].toLocaleString();
            total_c.innerText = last_data[0]["total_case"].toLocaleString();
            update_c.innerHTML = covert_date;
            recovered_c.innerText = last_data[0]["new_recovered"].toLocaleString();
            prev_c.innerText = last_data[0]["case_new_prev"].toLocaleString();
            total_recovered_c.innerText = last_data[0]["total_recovered"].toLocaleString();
            diff_c.innerText = last_data[0]["case_new_diff"].toLocaleString();
            new_death_c.innerText = last_data[0]["new_death"].toLocaleString();
            diff_death_c.innerText = last_data[0]["death_new_diff"].toLocaleString();
            
        })
        .catch((error) => {
            console.error(error)
        });
</script>


